# 质量控制文档

## 概述

此文档说明浏览器插件和合并脚本中的数据质量控制机制，确保导入项目的数据高质量、可用性强。

## 质量控制层级

### 1. 内容脚本层 (content.js)

**过滤规则** - 在抓取时排除明显的非提示词内容：

```javascript
const excludePatterns = [
  /^(breaking news|breaking:|just dropped|now (available|live)|incredible|wow,|Wow)/i,
  /prompt in (the )?alt|alt text/i,
  /^(Steps:|\\d+\\.|Check out)/i,
];
```

**内容长度检查**：
- 最少 30 字符 - 排除过短的评论
- 建议 50+ 字符 - 有实际提示词内容

**输出字段**：
- `quality: 'high' | 'medium'` - 在抓取阶段初步标记

### 2. 合并脚本层 (merge-data.js)

**质量评分系统** - 综合评估五个维度：

| 维度 | 权重 | 评分标准 |
|------|------|---------|
| 内容长度 | 25% | >150 chars: 25分 \| >80 chars: 15分 \| >30 chars: 8分 |
| 图片数量 | 25% | ≥2张: 25分 \| 1张: 15分 |
| 标签数量 | 20% | ≥3个: 20分 \| ≥1个: 10分 |
| 互动数据 | 20% | 赞+转发>100: 20分 \| >10: 10分 |
| 作者信息 | 10% | 有作者名称: 10分 |

**质量分级**：
- **高质量** (score > 50) - 内容充分、完整、有一定热度
- **中等质量** (30-50) - 基本可用，可能需要补充
- **低质量** (< 30) - 建议手动审查或排除

**输出字段**：
```json
{
  "quality": "high|medium|low",
  "qualityScore": 0-100,
  "authorAvatar": "url",
  "authorUrl": "url"
}
```

## 质量统计

### 案例分析
输入数据：51条原始抓取结果
经过新过滤条件后的质量分布：

```
优质条目: 13条 (25.5%)
中等条目: 38条 (74.5%)
低质条目:  0条 (0%)
```

### 质量提升

| 指标 | 前 | 后 | 改进 |
|------|-----|-----|-------|
| 有实际提示词 | 17/51 (33%) | 51/51 (100%) | +67% |
| 无效数据 | 34/51 (67%) | 0/51 (0%) | -67% |
| 平均评分 | N/A | 41/100 | - |

## 使用指南

### 导入数据时

```bash
npm run merge-prompts ai-prompts-1765472603202.json
```

脚本会输出：
```
📊 质量分布: 优[13] | 中[38] | 低[0]
📈 最终质量分布: 优[...] | 中[...] | 低[...]
💡 建议: 质量评分<30的条目建议手动审查
```

### 后续处理建议

**对于低质量条目**：
1. 在 merge-data.js 中添加过滤条件
2. 手动审查并清理
3. 为特殊类型条目（如教程）添加特殊标记

**对于中等质量条目**：
1. 保留在数据库中
2. 标记为 `quality: 'medium'`，方便前端区分
3. 可选：在UI中降低展示权重

**对于高质量条目**：
1. 优先在首页展示
2. 标记为 featured (可选)
3. 用于推荐算法

## 后续改进方向

### 短期
- [ ] 添加 OCR 识别图片中的提示词文本
- [ ] 支持多语言内容过滤
- [ ] 添加人工审核流程

### 中期
- [ ] 机器学习模型识别垃圾内容
- [ ] 社区反馈机制（用户标记垃圾/优质）
- [ ] 自动修复明显错误（URL、格式等）

### 长期
- [ ] 与原平台 API 集成（获取更新/删除状态）
- [ ] 分布式爬虫（多源聚合）
- [ ] 内容去重优化（基于向量相似度）

## FAQ

**Q: 为什么我的数据显示为低质量？**
A: 检查以下几点：
- 内容是否太短（<30字符）
- 是否缺少图片
- 是否是新发布的推文（互动数据较少）

**Q: 如何修改质量评分标准？**
A: 编辑 `merge-data.js` 中的 `assessQuality()` 函数，修改权重和阈值。

**Q: 低质量数据会被导入吗？**
A: 是的，所有数据都会被导入，但标记了质量等级。前端可选择性展示。

---

最后更新：2025-12-12
